close all
clearvars
SNR = 1:20;

qpsk_theo = [0.244712636475340,0.197235316836934,0.151567185347692,0.109798884378972,0.0739382701471101,0.0454849493163867,0.0250156328414713,0.0119727201442847,0.00482079677208622,0.00156478963694521,0.000387933313752354,6.86040710628266e-05,7.93848103775288e-06,5.39029550835111e-07,1.87220798937412e-08,2.79805561859967e-10,1.44719514170679e-12,1.96900048775960e-15,4.98903343571898e-19,1.52397060483212e-23];
qpsk_ISI =  [0.4723,0.4447,0.4258,0.4054,0.3882,0.3874,0.3770,0.3657,0.3609,0.3653,0.3573,0.3501,0.3409,0.3449,0.3401,0.3379,0.3401,0.3337,0.3373,0.3365];
qpsk_equ =[0.479028846153846,0.4695544871794872,0.3892740384615385,0.321602564102564,0.2496073717948718,0.1793205128205128,0.1396378205128205,0.0997435897435897,0.0596794871794872,0.0452564102564103,0.0196250000000000,0.00889410256410256,0.00290384615384615,0.000409641025641026,0,0,0,0,0,0];
qpsk_awgn = [0.468028846153846,0.4515544871794872,0.3712740384615385,0.2751602564102564,0.2346073717948718,0.1753205128205128,0.1336378205128205,0.0897435897435897,0.0496794871794872,0.0352564102564103,0.0156250000000000,0.00881410256410256,0.00240384615384615,0.000400641025641026,0,0,0,0,0,0];

 h=figure;
    semilogy(SNR,qpsk_theo, '-ko');
    hold on;
    semilogy(SNR,qpsk_ISI, '-g+');
    semilogy(SNR,qpsk_equ,'-mv');
    semilogy(SNR,qpsk_awgn, '-b^');
    ylabel('Probability of Error');
    xlabel('SNR (dB)');
    xlim([1 16]);
    ylim([10^-4 10^0]);
    legend('Theory (Symbol Error)', ...
        'Simulation /w No Equalization (Symbol Error)', ...
        'Simulation /w ZF Equalization (Symbol Error)',...
         'Simulation /w only AWGN  (Bit Error)','Location','SouthWest');
    % save the BER graph
    print(h,'-djpeg','-r300','qpSNR');
% 
 QAM16_theo = [0.710411481699279,0.675181837010267,0.634802483831270,0.588917786178000,0.537385132494246,0.480405158069127,0.418673776522992,0.353530505210356,0.287053900375816,0.222030850272438,0.161718625163473,0.109353288331707,0.0674575242350610,0.0371508456059155,0.0177818422418059,0.00715203849387628,0.00231668113680212,0.000572641319227025,0.000100879140980248,1.16162909118166e-05];
 QAM16_ISI =  [0.799357945425361,0.771027287319422,0.735778491171750,0.723306581059390,0.687319422150883,0.662439807383628,0.746388443017657,0.642375601926164,0.635152487961477,0.593418940609952,0.615890850722311,0.615890850722311,0.594221508828250,0.572552166934189,0.578972712680578,0.566131621187801,0.560513643659711,0.562921348314607,0.559711075441413,0.548475120385233];
 QAM16_equ = [0.789701444622793,0.783675762439807,0.74757624398074,0.701380417335474,0.687367576243981,0.659487961476726,0.613531300160514,0.553338683788122,0.496081861958266,0.44348314606742,0.395245585874799,0.307778491171750,0.245165329052970,0.179367576243981,0.124792937399679,0.0979107544141252,0.0505438202247191,0.0369130016051364,0.0159462279293740,0.008929825040128411];
 QAM16_awgn =  [0.781701444622793,0.773675762439807,0.736757624398074,0.681380417335474,0.677367576243981,0.652487961476726,0.603531300160514,0.543338683788122,0.463081861958266,0.421348314606742,0.389245585874799,0.305778491171750,0.239165329052970,0.177367576243981,0.122792937399679,0.0971107544141252,0.0449438202247191,0.0353130016051364,0.0144462279293740,0.00882825040128411];
 h=figure;
    semilogy(SNR,QAM16_theo, '-ko');
    hold on;
    semilogy(SNR,QAM16_ISI, '-g+');
    semilogy(SNR,QAM16_equ,'-mv');
    semilogy(SNR,QAM16_awgn, '-b^');
    ylabel('Probability of Error');
    xlabel('SNR (dB)');
    xlim([1 20]);
    ylim([10^-4 10^0]);
    legend('Theory (Symbol Error)', ...
        'Simulation /w No Equalization (Symbol Error)', ...
        'Simulation /w ZF Equalization (Symbol Error)',...
         'Simulation /w only AWGN  (Bit Error)','Location','SouthWest');
    % save the BER graph
    print(h,'-djpeg','-r300','qam16SNR');